data  = require 'euler/common/data'
parse = require 'euler/common/parse'

numbers = null

exports.initialize = ->
  numbers = parse.matrix data.getFilename()

exports.solve = ->
  max = 0

  for y in [0..19]
    for x in [0..16]
      for dir in [[0, 1], [1, 0], [1, 1], [-1, 1]]
        yDir = dir[0]
        xDir = dir[1]

        continue if yDir == -1 && y < 3
        continue if yDir == 1  && y > 16

        p = check(x, y, xDir, yDir)
        max = p if p > max

  return max

check = (x, y, xDir, yDir)->
  product = 1
  for i in [0..3]
    product *= numbers[y][x]
    x += xDir
    y += yDir
  return product